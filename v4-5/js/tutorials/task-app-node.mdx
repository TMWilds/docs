---
title : "Task App: Node.js"
---

To get started right away without having to build an app from scratch, explore with the Ditto ready-to-use demo task app.

This article provides a quickstart on building and interacting with a basic task app for managing and tracking task items.

## Code Overview with Comments
Following is an overview of the installation, setup, and build process with comments. For a step-by-step walkthrough:

For the full source code, see getditto > samples > nodejs > [index.ts](https://github.com/getditto/samples/blob/main/tasks/nodejs/index.ts "index.ts") repository in GitHub.

1. [Installing and Setting Up Ditto](https://docs.ditto.live/v4-5/js/tutorials/task-app-node#1ge_5)
2. [Building and Running the App](https://docs.ditto.live/v4-5/js/tutorials/task-app-node#ZWCaS)
3. [Creating New Task Documents](https://docs.ditto.live/v4-5/js/tutorials/task-app-node#hRPi7)
4. [Editing Task Documents](https://docs.ditto.live/v4-5/js/tutorials/task-app-node#TrgJ6)
5. [Replicating Data](https://docs.ditto.live/v4-5/js/tutorials/task-app-node#GEtMY)

```javascript JS
import { init, Ditto } from '@dittolive/ditto' 2import \* as readline from 'readline/promises' 3import { stdin as input, stdout as output } from 'node:process'; 4 5let ditto 6let liveQuery 7let tasks \= \[\] 8let subscription 9 10async function main () { 11 await init() 12 13 ditto \= new Ditto({ 14 type: 'onlinePlayground', 15 appID: 'YOUR\_APP\_ID', 16 token: 'YOUR\_TOKEN\_HERE'}) 17 18 ditto.startSync() 19 20 //// 21 // Data Replication Section 22 //// 23 24 // Subscribe to changes from other peers 25 subscription \= 26 ditto.store 27 .collection("tasks") 28 .find("isDeleted == false") 29 .subscribe() 30 31 //// 32 // Live Query Section 33 //// 34 35 const liveQueryCallback \= (docs, event) \=> { 36 tasks \= docs; 37 } 38 39 liveQuery \= 40 ditto.store 41 .collection("tasks") 42 .find("isDeleted == false") 43 .observeLocal(liveQueryCallback) 44 45 tasks \= await ditto.store 46 .collection("tasks") 47 .find("isDeleted == false") 48 49 //// 50 // Command Line Interface Section 51 //// 52 53 console.log("\*\*\*\*\*\*\*\*\*\*\*\*\* Commands \*\*\*\*\*\*\*\*\*\*\*\*\*") 54 console.log("--create <task name>"); 55 console.log(" Creates a task"); 56 console.log(" Example: \\"--insert My New Task\\""); 57 console.log("--toggle <task id>"); 58 console.log(" Toggles the isCompleted field"); 59 console.log(" Example: \\"--toggle 1234abc\\""); 60 console.log("--delete <task id>"); 61 console.log(" Deletes a task"); 62 console.log(" Example: \\"--delete 1234abc\\""); 63 console.log("--list"); 64 console.log(" List the current tasks"); 65 console.log("--exit"); 66 console.log(" Exits the program"); 67 console.log("\*\*\*\*\*\*\*\*\*\*\*\*\* Commands \*\*\*\*\*\*\*\*\*\*\*\*\*") 68 69 const rl \= readline.createInterface({ input, output }) 70 71 while (true) { 72 let answer \= await rl.question('Your command:') 73 74 if (answer.startsWith("--create")) { 75 // Upsert a new document into tasks 76 let body \= answer.replace("--create ", "") 77 ditto.store.collection("tasks").upsert({ 78 body, 79 isDeleted: false, 80 isCompleted: false 81 }) 82 } else if (answer.startsWith("--toggle")) { 83 // Find the document based on the id an toggle the 84 // 'isCompleted' field to true using the update API 85 const id \= answer.replace("--toggle ", "") 86 const toggleCompleted \= (doc) \=> { 87 const isCompleted \= doc.value.isCompleted 88 doc.at("isCompleted").set(!isCompleted) 89 } 90 ditto.store.collection("tasks") 91 .findByID(id).update(toggleCompleted) 92 } else if (answer.startsWith("--list")) { 93 console.log(tasks.map((task) \=> task.value)) 94 } else if (answer.startsWith("--delete")) { 95 // Find the document based on the id an set the 96 // 'isDeleted' field to true using the update API 97 const id \= answer.replace("--delete ", "") 98 const setDeleted \= (doc) \=> { 99 doc.at("isDeleted").set(true) 100 } 101 ditto.store.collection("tasks") 102 .findByID(id).update(setDeleted) 103 } else if (answer.startsWith("--exit")) { 104 ditto.stopSync() 105 process.exit() 106 } 107 } 108} 109 110main()
```

## Installing and Setting Up Ditto
Create a new directory, navigate to it, and then initialize npm:

1.

```bash
mkdir ditto-example cd ditto-example npm init
```
2.Install the @dittolive/ditto and readline package:

```bash
npm i @dittolive/ditto readline
```
3.Open the current directory in your IDE. For example, if using [Visual Studio Code](https://code.visualstudio.com/ "Visual Studio Code"):

```bash

code .
```
4.Import and initialize Ditto:

1. Create an index.js file, and then import, initialize, instantiate, and start Ditto by adding the following to it.
2. Replace 'YOUR\_APP\_ID' and 'YOUR\_TOKEN' with your access credentials.

<Info>
To get your access credentials, you must create an account and register an app in the portal. For instructions, see [Onboarding](https://docs.ditto.live/v4-5/onboarding)ï»¿.
</Info>

```javascript JS
import { init, Ditto } from '@dittolive/ditto' 2 3let ditto 4 5async function main () { 6 // Initialize the Ditto module 7 await init() 8 9 // Create a Ditto instance 10 ditto \= new Ditto({ 11 type: 'onlinePlayground', 12 appID: 'YOUR\_APP\_ID', 13 token: 'YOUR\_TOKEN\_HERE'}) 14 15 // Start synchronization 16 ditto.startSync() 17} 18 19main()
```

# Setting Up the App
Once you've installed and set up your environment with Ditto, create a command-line interface (CLI) along with the various placeholder logic, or *stubs*, for the methods you'll use to perform various operations:

```javascript JS
import { init, Ditto } from '@dittolive/ditto' 2 3// Add new import modules 4import \* as readline from 'readline/promises' 5import { stdin as input, stdout as output } from 'node:process'; 6 7let ditto: Ditto | undefined 8 9async function main () { 10 // Initialize the Ditto module 11 await init() 12 13 // Create a Ditto instance 14 ditto \= new Ditto({ 15 type: 'onlinePlayground', 16 appID: 'YOUR\_APP\_ID', 17 token: 'YOUR\_TOKEN\_HERE'}) 18 19 // Start synchronization 20 ditto.startSync() 21 22 //// 23 // Data Replication Section 24 //// 25 26 // ... 27 28 //// 29 // Live Query Section 30 //// 31 32 // ... 33 34 //// 35 // Command Line Interface Section 36 //// 37 38 console.log("\*\*\*\*\*\*\*\*\*\*\*\*\* Commands \*\*\*\*\*\*\*\*\*\*\*\*\*") 39 console.log("--create <task name>"); 40 console.log(" Creates a task"); 41 console.log(" Example: \\"--insert My New Task\\""); 42 console.log("--toggle <task id>"); 43 console.log(" Toggles the isComplete field"); 44 console.log(" Example: \\"--toggle 1234abc\\""); 45 console.log("--delete <task id>"); 46 console.log(" Deletes a task"); 47 console.log(" Example: \\"--delete 1234abc\\""); 48 console.log("--list"); 49 console.log(" List the current tasks"); 50 console.log("--exit"); 51 console.log(" Exits the program"); 52 console.log("\*\*\*\*\*\*\*\*\*\*\*\*\* Commands \*\*\*\*\*\*\*\*\*\*\*\*\*") 53 54 // Create a new readline interface 55 const rl \= readline.createInterface({ input, output }) 56 57 while (true) { 58 let answer \= await rl.question('Your command:') 59 60 if (answer.startsWith("--create")) { 61 // --create logic stub 62 } else if (answer.startsWith("--toggle")) { 63 // --toggle logic stub 64 } else if (answer.startsWith("--list")) { 65 // --list logic stub 66 } else if (answer.startsWith("--delete")) { 67 // --delete logic stub 68 } else if (answer.startsWith("--exit")) { 69 ditto.stopSync() 70 process.exit() 71 } 72 } 73} 74 75main()
```

# Building and Running the App
Now that you have the app's CLI implemented, build and run the task app:

```bash
node index.js
```

The following output CLI indicates that the demo task app is running.

```Output
\*\*\*\*\*\*\*\*\*\*\*\*\* Commands \*\*\*\*\*\*\*\*\*\*\*\*\* --create <task name> Inserts a task Example: "--create My New Task" --toggle <task id> Toggles the isComplete field Example: "--toggle 1234abc" --delete <task id> Deletes a task Example: "--delete 1234abc" --list List the current tasks --exit Exits the program \*\*\*\*\*\*\*\*\*\*\*\*\* Commands \*\*\*\*\*\*\*\*\*\*\*\*\* Your command:
```
## Performing Reads
Now that the setup is complete, create a *live query*. A live query is a mechanism that allows you to track specific changes stored within the local environment, referred to as the *Ditto store*.

Relevant documents are stored in a local tasks object; as these documents change, the tasks object automatically updates to reflect their most current state that automatically updates to reflect the latest state. As data changes occur, the tasks object updates to reflect the latest state.

Once you've installed and set up the Ditto SDK, create a live query that will allow us to see when changes we care about happen to our local store. We store any relevant documents in a local tasks object and update the tasks object as changes happen using the live query.

We'll also implement our \--list command to return known documents.

1.Implement live query logic and \--list command

```javascript  JS
import { init, Ditto } from '@dittolive/ditto' 2import \* as readline from 'readline/promises' 3import { stdin as input, stdout as output } from 'node:process'; 4 5let ditto 6 7// Add a liveQuery variable to store the LiveQuery object 8// The liveQuery must be kept in a location where it will not be 9// cleaned up by the garbage collector 10let liveQuery 11 12// Create a new tasks object to store known task documents 13let tasks \= \[\] 14 15async function main () { 16 await init() 17 18 ditto \= new Ditto({ 19 type: 'onlinePlayground', 20 appID: 'YOUR\_APP\_ID', 21 token: 'YOUR\_TOKEN\_HERE'}) 22 23 ditto.startSync() 24 25 //// 26 // Data Replication Section 27 //// 28 29 //... 30 31 //// 32 // Live Query Section 33 //// 34 35 // Callback that will be triggered 36 const liveQueryCallback \= (docs, event) \=> { 37 // Store documents that match our query in the local tasks object 38 tasks \= docs; 39 } 40 41 // Create a live query that will trigger or callback 42 liveQuery \= 43 ditto.store 44 .collection("tasks") 45 .find("isDeleted == false") 46 .observeLocal(liveQueryCallback) 47 48 // Get an initial set of data from the store after setting the 49 // live query. This ensures we don't have any stale initial data. 50 tasks \= 51 await ditto.store 52 .collection("tasks") 53 .find("isDeleted == false") 54 55 //// 56 // Command Line Interface Section 57 //// 58 59 console.log("\*\*\*\*\*\*\*\*\*\*\*\*\* Commands \*\*\*\*\*\*\*\*\*\*\*\*\*") 60 console.log("--create <task name>"); 61 console.log(" Creates a task"); 62 console.log(" Example: \\"--insert My New Task\\""); 63 console.log("--toggle <task id>"); 64 console.log(" Toggles the isComplete field"); 65 console.log(" Example: \\"--toggle 1234abc\\""); 66 console.log("--delete <task id>"); 67 console.log(" Deletes a task"); 68 console.log(" Example: \\"--delete 1234abc\\""); 69 console.log("--list"); 70 console.log(" List the current tasks"); 71 console.log("--exit"); 72 console.log(" Exits the program"); 73 console.log("\*\*\*\*\*\*\*\*\*\*\*\*\* Commands \*\*\*\*\*\*\*\*\*\*\*\*\*") 74 75 const rl \= readline.createInterface({ input, output }) 76 77 while (true) { 78 let answer \= await rl.question('Your command:') 79 80 if (answer.startsWith("--create")) { 81 // --create logic stub 82 } else if (answer.startsWith("--toggle")) { 83 // --toggle logic stub 84 } else if (answer.startsWith("--list")) { 85 // console log known tasks 86 console.log(tasks.map((task) \=> task.value)) 87 } else if (answer.startsWith("--delete")) { 88 // --delete logic stub 89 } else if (answer.startsWith("--exit")) { 90 ditto.stopSync() 91 process.exit() 92 } 93 } 94} 95 96main()
```

2.Run the \--list command in the console. The output should be an empty array.

```bash
Your command:--list
```

```Output

\[\]
```

## Creating New Task Documents
We'll now extend our application with the ability to create new task documents in the Ditto store using the Upsert method. We'll do this by implementing the \--create command in our application.

1.Implement \--create command logic

```javascript  JS
import { init, Ditto } from '@dittolive/ditto' 2import \* as readline from 'readline/promises' 3import { stdin as input, stdout as output } from 'node:process'; 4 5let ditto 6let liveQuery 7let tasks \= \[\] 8 9async function main () { 10 await init() 11 12 ditto \= new Ditto({ 13 type: 'onlinePlayground', 14 appID: 'YOUR\_APP\_ID', 15 token: 'YOUR\_TOKEN\_HERE'}) 16 17 ditto.startSync() 18 19 //// 20 // Data Replication Section 21 //// 22 23 //... 24 25 //// 26 // Live Query Section 27 //// 28 29 const liveQueryCallback \= (docs, event) \=> { 30 tasks \= docs; 31 } 32 33 liveQuery \= 34 ditto.store 35 .collection("tasks") 36 .find("isDeleted == false") 37 .observeLocal(liveQueryCallback) 38 39 tasks \= 40 await ditto.store 41 .collection("tasks") 42 .find("isDeleted == false") 43 44 //// 45 // Command Line Interface Section 46 //// 47 48 console.log("\*\*\*\*\*\*\*\*\*\*\*\*\* Commands \*\*\*\*\*\*\*\*\*\*\*\*\*") 49 console.log("--create <task name>"); 50 console.log(" Creates a task"); 51 console.log(" Example: \\"--insert My New Task\\""); 52 console.log("--toggle <task id>"); 53 console.log(" Toggles the isComplete field"); 54 console.log(" Example: \\"--toggle 1234abc\\""); 55 console.log("--delete <task id>"); 56 console.log(" Deletes a task"); 57 console.log(" Example: \\"--delete 1234abc\\""); 58 console.log("--list"); 59 console.log(" List the current tasks"); 60 console.log("--exit"); 61 console.log(" Exits the program"); 62 console.log("\*\*\*\*\*\*\*\*\*\*\*\*\* Commands \*\*\*\*\*\*\*\*\*\*\*\*\*") 63 64 const rl \= readline.createInterface({ input, output }) 65 66 while (true) { 67 let answer \= await rl.question('Your command:') 68 69 if (answer.startsWith("--create")) { 70 // Upsert a new document into tasks 71 let body \= answer.replace("--create ", "") 72 ditto.store.collection("tasks").upsert({ 73 body, 74 isDeleted: false, 75 isCompleted: false 76 }) 77 } else if (answer.startsWith("--toggle")) { 78 // --toggle logic stub 79 } else if (answer.startsWith("--list")) { 80 console.log(tasks.map((task) \=> task.value)) 81 } else if (answer.startsWith("--delete")) { 82 // --delete logic stub 83 } else if (answer.startsWith("--exit")) { 84 ditto.stopSync() 85 process.exit() 86 } 87 } 88} 89 90main()
```

2.Run the \--create My First Task command.

3.Run the \--list command.

By default, the document \_id is automatically generated.

```Output

\[ { \_id: '64c9b6480049a0c400c95c51', body: 'My First Task', isCompleted: false, isDeleted: false } \]
```
4.You can now open the data browser in the Ditto Portal to see the changes in the Big Peer. ([https://portal.ditto.live/data-browser/{APP-ID}](https://portal.ditto.live/ "https://portal.ditto.live/data-browser/{APP-ID}"))

# Editing Task Documents
We'll now extend our application to support editing documents. To do this we'll introduce:

1. The ability to mark a file as deleted by setting the isDeleted field to true.
2. The ability to chage the complteted state by being able to toggle the isComplete field

1.Add logic for \--toggle and \--deleted input.

```JS
import { init, Ditto } from '@dittolive/ditto' 2import \* as readline from 'readline/promises' 3import { stdin as input, stdout as output } from 'node:process'; 4 5let ditto 6let liveQuery 7let tasks \= \[\] 8 9async function main () { 10 await init() 11 12 ditto \= new Ditto({ 13 type: 'onlinePlayground', 14 appID: 'YOUR\_APP\_ID', 15 token: 'YOUR\_TOKEN\_HERE'}) 16 17 ditto.startSync() 18 19 //// 20 // Data Replication Section 21 //// 22 23 //... 24 25 //// 26 // Live Query Section 27 //// 28 29 const liveQueryCallback \= (docs, event) \=> { 30 tasks \= docs; 31 } 32 33 liveQuery \= 34 ditto.store 35 .collection("tasks") 36 .find("isDeleted == false") 37 .observeLocal(liveQueryCallback) 38 39 tasks \= 40 await ditto.store 41 .collection("tasks") 42 .find("isDeleted == false") 43 44 //// 45 // Command Line Interface Section 46 //// 47 48 console.log("\*\*\*\*\*\*\*\*\*\*\*\*\* Commands \*\*\*\*\*\*\*\*\*\*\*\*\*") 49 console.log("--create <task name>"); 50 console.log(" Creates a task"); 51 console.log(" Example: \\"--insert My New Task\\""); 52 console.log("--toggle <task id>"); 53 console.log(" Toggles the isCompleted field"); 54 console.log(" Example: \\"--toggle 1234abc\\""); 55 console.log("--delete <task id>"); 56 console.log(" Deletes a task"); 57 console.log(" Example: \\"--delete 1234abc\\""); 58 console.log("--list"); 59 console.log(" List the current tasks"); 60 console.log("--exit"); 61 console.log(" Exits the program"); 62 console.log("\*\*\*\*\*\*\*\*\*\*\*\*\* Commands \*\*\*\*\*\*\*\*\*\*\*\*\*") 63 64 const rl \= readline.createInterface({ input, output }) 65 66 while (true) { 67 let answer \= await rl.question('Your command:') 68 69 if (answer.startsWith("--create")) { 70 // Upsert a new document into tasks 71 let body \= answer.replace("--create ", "") 72 ditto.store.collection("tasks").upsert({ 73 body, 74 isDeleted: false, 75 isCompleted: false 76 }) 77 } else if (answer.startsWith("--toggle")) { 78 // Find the document based on the id an toggle the 79 // 'isCompleted' field to true using the update API 80 const id \= answer.replace("--toggle ", "") 81 const toggleCompleted \= (doc) \=> { 82 const isCompleted \= doc.value.isCompleted 83 doc.at("isCompleted").set(!isCompleted) 84 } 85 ditto.store.collection("tasks") 86 .findByID(id).update(toggleCompleted) 87 } else if (answer.startsWith("--list")) { 88 console.log(tasks.map((task) \=> task.value)) 89 } else if (answer.startsWith("--delete")) { 90 // Find the document based on the id an set the 91 // 'isDeleted' field to true using the update API 92 const id \= answer.replace("--delete ", "") 93 const setDeleted \= (doc) \=> { 94 doc.at("isDeleted").set(true) 95 } 96 ditto.store.collection("tasks") 97 .findByID(id).update(setDeleted) 98 } else if (answer.startsWith("--exit")) { 99 ditto.stopSync() 100 process.exit() 101 } 102 } 103} 104 105main()
```
2.Run the \--list command to get known documents. (Note: The \_id is generated and will be different)

```Output

\[ { \_id: '64c9b6480049a0c400c95c51', body: 'My First Task', isCompleted: false, isDeleted: false } \]
```
3.Run the \--toggle command with the \_id of the document you want to change isCompleted state of. In our case it's document 64c9b6480049a0c400c95c51.

4.Run the \--list command to see state update.

```Output

\[ { \_id: '64c9b6480049a0c400c95c51', body: 'My First Task', isCompleted: true, isDeleted: false } \]
```
5.Run the \--delete command with the \_id of the document you want to set to deleted. In our case it's document 64c9b6480049a0c400c95c51.

6.Run the \--list command to see state update. We now have an empty list because our live query is only subscribing to documents that have "isDeleted == false"

```Output

\[\]
```

# Replicating Data
Finally, we'll extend our application to replicate data from other locally connected peers. We'll do this by adding a subscription with a query that matches our live query.

1.Add a subscription with a query that looks for documents in the tasks collection with "isDeleted == false"



```TypeScript
import { init, Ditto } from '@dittolive/ditto' 2 3let ditto 4 5// Add a subscription variable to store the Subscription object 6// The subscription must be kept in a location where it will not be 7// cleaned up by the garbage collector 8let subscription 9 10async function main () { 11 await init() 12 13 ditto \= new Ditto({ 14 type: 'onlinePlayground', 15 appID: 'YOUR\_APP\_ID', 16 token: 'YOUR\_TOKEN\_HERE'}) 17 18 ditto.startSync() 19 20 // Start a new subscription 21 subscription \= 22 ditto.store 23 .collection("tasks") 24 .find("isDeleted == false") 25 .subscribe() 26} 27 28main()
```
